generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["referentialIntegrity"]
}

datasource db {
  provider             = "mysql"
  url                  = env("DATABASE_URL")
  referentialIntegrity = "prisma"
}

model Account {
  id              Int             @id
  flow_type       AccountFlowType
  name            String          @default("") @db.VarChar(20)
  nome            String          @default("") @db.VarChar(20)
  journal_entries JournalEntry[]
}

model Apartment {
  id               Int              @id
  floor            Int              @default(0)
  tenant           String           @default("") @db.VarChar(255)
  monthly_payments MonthlyPayment[]
  journal_entries  JournalEntry[]
}

model Configuration {
  id                  Int      @id
  valid_from          DateTime @db.Date
  stairs_cleaning_fee Decimal  @default(0.00) @db.Decimal(10, 2)
  cleanings_per_month Int      @default(2)
  monthly_dues        Decimal  @default(0.00) @db.Decimal(10, 2)
}

model JournalEntry {
  id           Int        @id @default(autoincrement())
  date         DateTime   @db.Date
  debit        Decimal    @default(0.00) @db.Decimal(10, 2)
  credit       Decimal    @default(0.00) @db.Decimal(10, 2)
  account      Account?   @relation(fields: [account_id], references: [id])
  account_id   Int
  apartment    Apartment? @relation(fields: [apartment_id], references: [id])
  apartment_id Int?
  description  String?    @db.VarChar(255)
  booked       Boolean    @default(false)
}

model MonthlyPayment {
  id           Int       @id @default(autoincrement())
  month        Int       @default(0)
  year         Int       @default(0)
  apartment    Apartment @relation(fields: [apartment_id], references: [id])
  apartment_id Int
  amount       Decimal   @default(0.00) @db.Decimal(10, 2)

  @@unique([month, year, apartment_id], map: "MonthlyPayment_month_year_apartment_id_unique_constraint")
}

enum AccountFlowType {
  debit
  credit
}
